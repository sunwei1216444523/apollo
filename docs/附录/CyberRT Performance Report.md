## Introduction

The purpose of this performance report is to compare the results of the old and new versions of cyberRT in terms of cross-process/cross-machine transmission under different transmission conditions, and to present detailed data on the transmission metrics when using different modules/sensors (Functional Module, Normal Sensor and High-End Sensor). All results are generated by the cyber_benchmark benchmarking tool.

## Environment

### Platform 1:

<table>
  <tbody>
    <tr>
      <td rowspan="3">Hardware</td>
      <td>cpu</td>
      <td>Intel(R) Core(TM) i9-9900K</td>
    </tr>
    <tr>
      <td>memory</td>
      <td>2 x Innodisk M4S0-AGS1OCIK DDR4 16GiB 2667 MHz</td>
    </tr>
    <tr>
      <td>store</td>
      <td>Samsung SSD 980 500GB</td>
    </tr>
    <tr>
      <td rowspan="3">Software</td>
      <td>system</td>
      <td>Ubuntu 18.04.5 2021.09.12 LTS</td>
    </tr>
    <tr>
      <td>kernel</td>
      <td>5.4.0-150-generic</td>
    </tr>
    <tr>
      <td>CyberRT version</td>
      <td>Apollo 9.0 / Apollo 10.0</td>
    </tr>
  </tbody>
</table>

### Platform 2:

<table>
  <tbody>
    <tr>
      <td rowspan="3">Hardware</td>
      <td>cpu</td>
      <td>8 core Arm® Cortex®-A78AE v8.2</td>
    </tr>
    <tr>
      <td>memory</td>
      <td>32GiB 256 bit LPDDR5 Onboard Memory 204.8GB/s</td>
    </tr>
    <tr>
      <td>store</td>
      <td>KINGSTON OM8PGP41024Q-A0</td>
    </tr>
    <tr>
      <td rowspan="3">Software</td>
      <td>system</td>
      <td>Ubuntu 20.04.4 LTS</td>
    </tr>
    <tr>
      <td>kernel</td>
      <td>5.10.104-tegra</td>
    </tr>
    <tr>
      <td>CyberRT version</td>
      <td>Apollo 9.0 / Apollo 10.0</td>
    </tr>
  </tbody>
</table>

## Cross-Process transmission Performance Test Results

This test will examine the performance of both the old and new versions of cyberRT with different message sizes and sending frequencies.

### different message size

All tests were performed with message sizes of 16B, 1KB, 64KB ..... .5MB, 10MB, and conducted at 100 hz

The following images show the cpu usage, memory usage, message transfer latency, and packet loss metrics for transferring different message sizes on Platform 1. In this case, cyberRT of Apollo 10.0 has arena zero-copy communication enabled and arena shared memory is configured with 1GB size:

<table>
  <tbody>
    <tr>
      <td><img src="./images/cyber_performance_report_1.png" alt="cyber_performance_report_1" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_2.png" alt="cyber_performance_report_2" style="zoom:50%;" /></td>
    </tr>
    <tr>
      <td><img src="./images/cyber_performance_report_3.png" alt="cyber_performance_report_3" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_4.png" alt="cyber_performance_report_4" style="zoom:50%;" /></td>
    </tr>
  </tbody>
</table>

The following images show the cpu usage, memory usage, message transfer latency, and packet loss metrics for transferring different message sizes on Platform 2. In this case, cyberRT of Apollo 10.0 has arena zero-copy communication enabled and arena shared memory is configured with 1GB size:

<table>
  <tbody>
    <tr>
      <td><img src="./images/cyber_performance_report_5.png" alt="cyber_performance_report_5" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_6.png" alt="cyber_performance_report_6" style="zoom:50%;" /></td>
    </tr>
    <tr>
      <td><img src="./images/cyber_performance_report_7.png" alt="cyber_performance_report_7" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_8.png" alt="cyber_performance_report_8" style="zoom:50%;" /></td>
    </tr>
  </tbody>
</table>

### different sending frequencies

All tests were performed at message frequencies of 10 hz, 20 hz, 50 hz, and 100 hz with a message size of 1 MB

The following images show the cpu usage, memory usage, message transfer latency, and packet loss rate metrics for transmitting different send frequencies on Platform 1. In this case, cyberRT of Apollo 10.0 has arena zero-copy communication enabled and arena shared memory is configured with 1GB size:

<table>
  <tbody>
    <tr>
      <td><img src="./images/cyber_performance_report_9.png" alt="cyber_performance_report_9" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_10.png" alt="cyber_performance_report_10" style="zoom:50%;" /></td>
    </tr>
    <tr>
      <td><img src="./images/cyber_performance_report_11.png" alt="cyber_performance_report_11" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_12.png" alt="cyber_performance_report_12" style="zoom:50%;" /></td>
    </tr>
  </tbody>
</table>

The following images show the cpu usage, memory usage, message transfer latency, and packet loss rate metrics for transmitting different send frequencies on Platform 2. In this case, cyberRT of Apollo 10.0 has arena zero-copy communication enabled and arena shared memory is configured with 1GB size:

<table>
  <tbody>
    <tr>
      <td><img src="./images/cyber_performance_report_13.png" alt="cyber_performance_report_13" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_14.png" alt="cyber_performance_report_14" style="zoom:50%;" /></td>
    </tr>
    <tr>
      <td><img src="./images/cyber_performance_report_15.png" alt="cyber_performance_report_15" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_16.png" alt="cyber_performance_report_16" style="zoom:50%;" /></td>
    </tr>
  </tbody>
</table>

### performance of Apollo 10.0 cyberRT in different scenarios for cross-process transfers under platform 1

|                                                    | message size/frequency | cpu usage | latency  | msg loss rate | memory usage                     |
| -------------------------------------------------- | ---------------------- | --------- | -------- | ------------- | -------------------------------- |
| Functional Module(perception, planning etc.)       | 64K/10hz               | 9.14%     | 84.6 us  | 0.0%          | 250MB                            |
| High Frequencies functional Module（localization） | 64k/100hz              | 9.71%     | 69.54 us | 0.0%          | 250M + 1024M arena shared memory |
| Normal Sensor Module                               | 1M/10hz                | 8.47%     | 82.29 us | 0.0%          | 250M + 1024M arena shared memory |
| High-End Sensor Module                             | 10M/10hz               | 5.55%     | 58.95 us | 0.0%          | 250M + 1024M arena shared memory |

## Cross-machine transfer performance test results

This test will examine the performance of both the old and new versions of cyberRT with different message sizes and sending frequencies.

### different message size

All tests were performed with message sizes of 1KB, 64KB ..... .5MB, 10MB, and conducted at 100 hz

The following images show the cpu usage, memory usage, message transfer latency, and packet loss rate metrics for transferring different message sizes on Platform 1. The cyberRT of Apollo 10.0 is based on FastDDS version 2.x and the 9.0 cyberRT is based on fastrtps version 1.5:

<table>
  <tbody>
    <tr>
      <td><img src="./images/cyber_performance_report_17.png" alt="cyber_performance_report_17" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_18.png" alt="cyber_performance_report_18" style="zoom:50%;" /></td>
    </tr>
    <tr>
      <td><img src="./images/cyber_performance_report_19.png" alt="cyber_performance_report_19" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_20.png" alt="cyber_performance_report_20" style="zoom:50%;" /></td>
    </tr>
  </tbody>
</table>

The following images show the cpu usage, memory usage, message transfer latency, and packet loss rate metrics for transferring different message sizes on Platform 2. The cyberRT of Apollo 10.0 is based on FastDDS version 2.x and the 9.0 cyberRT is based on fastrtps version 1.5:

<table>
  <tbody>
    <tr>
      <td><img src="./images/cyber_performance_report_21.png" alt="cyber_performance_report_21" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_22.png" alt="cyber_performance_report_22" style="zoom:50%;" /></td>
    </tr>
    <tr>
      <td><img src="./images/cyber_performance_report_23.png" alt="cyber_performance_report_23" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_24.png" alt="cyber_performance_report_24" style="zoom:50%;" /></td>
    </tr>
  </tbody>
</table>

### different sending frequencies

All tests were performed at message frequencies of 10 hz, 20 hz, 50 hz, and 100 hz with a message size of 1 MB

The following images show the cpu usage, memory usage, message transfer latency, and packet loss rate metrics for transferring different message sizes on Platform 1. The cyberRT of Apollo 10.0 is based on FastDDS version 2.x and the 9.0 cyberRT is based on fastrtps version 1.5:

<table>
  <tbody>
    <tr>
      <td><img src="./images/cyber_performance_report_25.png" alt="cyber_performance_report_25" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_26.png" alt="cyber_performance_report_26" style="zoom:50%;" /></td>
    </tr>
    <tr>
      <td><img src="./images/cyber_performance_report_27.png" alt="cyber_performance_report_27" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_28.png" alt="cyber_performance_report_28" style="zoom:50%;" /></td>
    </tr>
  </tbody>
</table>

The following images show the cpu usage, memory usage, message transfer latency, and packet loss rate metrics for transferring different message sizes on Platform 2. The cyberRT of Apollo 10.0 is based on FastDDS version 2.x and the 9.0 cyberRT is based on fastrtps version 1.5:

<table>
  <tbody>
    <tr>
      <td><img src="./images/cyber_performance_report_29.png" alt="cyber_performance_report_29" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_30.png" alt="cyber_performance_report_30" style="zoom:50%;" /></td>
    </tr>
    <tr>
      <td><img src="./images/cyber_performance_report_31.png" alt="cyber_performance_report_31" style="zoom:50%;" /></td>
      <td><img src="./images/cyber_performance_report_32.png" alt="cyber_performance_report_32" style="zoom:50%;" /></td>
    </tr>
  </tbody>
</table>

### Performance of Apollo 10.0 cyberRT in different scenarios for cross-machine transfers under platform 1

|                                                    | message size/frequency | cpu usage | latency  | msg loss rate | memory usage |
| -------------------------------------------------- | ---------------------- | --------- | -------- | ------------- | ------------ |
| Functional Module(perception, planning etc.)       | 64K/10hz               | 7.75%     | 391 us   | 0.0%          | 247MB        |
| High Frequencies functional Module（localization） | 64k/100hz              | 10.3%     | 369 us   | 0.0%          | 249M         |
| Normal Sensor Module                               | 1M/10hz                | 8.84%     | 2124 us  | 0.0%          | 251M         |
| High-End Sensor Module                             | 10M/10hz               | 18.8%     | 18886 us | 0.0%          | 288M         |
